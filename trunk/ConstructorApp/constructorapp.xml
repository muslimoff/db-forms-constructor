<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<root attribute1="x" attribute2="y">
	<dbConnections>
		<defaultValues dbusername="FORMS_CONSTRUCTOR"
			fcSchemaOwner="FORMS_CONSTRUCTOR" debug="true" title="Forms Constructor" />
		<server display="NBAPPLPR">10.0.14.10:1521:APPLPR</server>
		<server display="DemoLocal">apps.abssoft.kz:1522:DEMO12i</server>
		<server display="BAS_11">apps.ba-solutions.kz:1522:DEMO</server>
		<server display="VM_XE" default="true">VM_XE:1521:XE</server>
		<server display="VIS12">rdbms.abssoft.kz:1524:VIS12</server>
		<server display="VIS12_IP">192.168.110.3:1524:VIS12</server>
		<server display="EPM-Конструктор" allowuserchange="false"
			debug="true" title="EPM - Forms Constructor">hypo:1521:epm</server>
		<server display="EPM_EXT-Конструктор" allowuserchange="false"
			default="true" debug="true" title="EPM Ext - Forms Constructor">hypo:8521:epm</server>
		<server display="EPM_RATES-Тарифы" dbusername="APP_RATES"
			default="false" dbpassword="" allowuserchange="false" debug="true"
			title="Формирование тарифов на медицинские услуги">hypo:1521:epm</server>
		<server display="EPM_RATES_EXT-Тарифы" dbusername="APP_RATES"
			dbpassword="A" allowuserchange="false" debug="true"
			title="Формирование тарифов на медицинские услуги">hypo:8521:epm</server>
		<server display="VIS12_full">
			<![CDATA[
			(DESCRIPTION =
				(ADDRESS_LIST=
					(ADDRESS = (PROTOCOL = TCP)(HOST = rdbms.abssoft.kz)(PORT = 1524)
					)
				)
				(CONNECT_DATA =(SID = VIS12)(SERVER = DEDICATED)
				)
			)
			]]>
		</server>
	</dbConnections>
	<metadataQuery>
		<!--formSQL-->
		<sqlStatement name="formSQL">
			<![CDATA[
				Select *
				  From forms_v a
				 Where a.form_code = :p_form_code
			]]>
		</sqlStatement>
		<!--extendedFormSQL-->
		<sqlStatement name="extendedFormSQL">
			<![CDATA[
				Select form_utils.get_extended_sql_text (a.sql_text)
				  From forms_v a
				 Where a.form_code = :p_form_code
			]]>
		</sqlStatement>
		<!--ColumnsMetaDataSQL-->
		<sqlStatement name="ColumnsMetaDataSQL">
			<![CDATA[
				Select   column_display_number, form_code, column_code, column_data_type, column_user_name, column_display_size
						,pimary_key_flag, show_on_grid, tree_initialization_value, tree_field_type, editor_tab_code, field_type
						,column_description, is_frozen_flag, show_hover_flag, exists_in_metadata_flag, exists_in_query_flag
						,lookup_code, hover_column_code, editor_height, lookup_field_type, help_text, text_mask
						,validation_regexp, default_orderby_number, default_value, editor_title_orientation, editor_end_row_flag
       					,editor_cols_span
				  From Table (form_utils.describe_form_columns_pl (:p_form_code))
			  Order By form_code, column_display_number, column_code
			]]>
		</sqlStatement>
		<!--formActionsSQL-->
		<sqlStatement name="formActionsSQL">
			<![CDATA[
				Select   *
				 From form_actions a
				Where a.form_code = :p_form_code
			 Order By form_code, display_number, action_code 
			]]>
		</sqlStatement>
		<!--argsSQLText-->
		<sqlStatement name="argsSQLText">
			<![CDATA[
				Select   a.Position, a.argument_name, DECODE (a.in_out, 'IN/OUT', 'Y', 'IN', 'Y') in_flag
						,DECODE (a.in_out, 'IN/OUT', 'Y', 'OUT', 'Y') out_flag
				  From all_arguments a
				 Where a.package_name || '.' || a.object_name = UPPER (:p_procedure_name)
				   And (a.owner = User or a.owner =:p_fc_schema_owner)
				   And a.Position != 0
				   And a.argument_name Is Not Null
			  Order By a.Position, a.Sequence
			]]>
		</sqlStatement>
		<!--detailFormSQL-->
		<sqlStatement name="detailFormSQL">
			<![CDATA[
				Select   *
				  From form_tabs_v a
				 Where a.form_code = :p_form_code
			  Order By tab_display_number, tab_name, tab_code
			]]>
		</sqlStatement>
		<!--statLookupsSQL-->
		<sqlStatement name="statLookupsSQL">
			<![CDATA[
				Select l.lookup_code, lv.lookup_value_code, lv.lookup_display_value
				  From lookups l, lookup_values lv
				 Where l.lookup_code = lv.lookup_code
			  Order By l.lookup_code, lv.lookup_value_code
			]]>
		</sqlStatement>
		<!--menusSQLOld-->
		<sqlStatement name="menusSQLOld">
			<![CDATA[
				Select * From forms_v a Order By a.form_name
			]]>
		</sqlStatement>
		<!--menusSQL-->
		<sqlStatement name="menusSQL">
			<![CDATA[
WITH m
       AS (SELECT   NVL2 (a.ROWID, a.menu_code, f.form_code) AS menu_code, a.menu_name AS menu_name,
                    NVL2 (a.ROWID, a.parent_menu_code, 'XXX') AS parent_menu_code, a.menu_position,
                    NVL (a.show_in_navigator, 'Y') AS show_in_navigator, f.icon_id, f.hot_key, f.form_code,
                    NVL (f.form_name, f.form_code) AS form_name, f.description
             FROM      menus a
                    FULL OUTER JOIN
                       forms f
                    ON a.menu_form_code = f.form_code
           UNION ALL
           SELECT   'XXX' AS menu_code, 'Прочее' AS menu_name, NULL AS parent_menu_code, NULL AS menu_position,
                    'Y' AS show_in_navigator, NULL AS icon_id, NULL AS hot_key, 'XXXX' AS form_code,
                    'XXXXX' AS form_name, NULL AS description
             FROM   DUAL)
           SELECT   LEVEL lvl, m.menu_code, m.parent_menu_code, m.menu_position, m.show_in_navigator,
                    NVL (NVL (m.menu_name, m.form_name), m.menu_code) AS menu_name, m.form_code, m.form_name, m.icon_id, m.hot_key,
                    (SELECT   --проблема с CLOB
                              description
                       FROM   forms f
                      WHERE   f.form_code = m.form_code)
                       description, (SELECT   COUNT ( * )
                                       FROM   m m1
                                      WHERE   m1.parent_menu_code = m.menu_code)
                                       child_count
             FROM   m
       CONNECT BY   PRIOR m.menu_code = m.parent_menu_code
       START WITH   m.parent_menu_code IS NULL
--ORDER SIBLINGS BY   m.parent_menu_code, m.menu_position, menu_name
         ORDER BY  lvl,  m.parent_menu_code, m.menu_position, menu_name
			]]>
		</sqlStatement>
		<!--iconsSQL-->
		<sqlStatement name="iconsSQL">
			<![CDATA[
				Select * From icons i
			]]>
		</sqlStatement>
	</metadataQuery>
</root>
